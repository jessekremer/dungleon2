pico-8 cartridge // http://www.pico-8.com
version 35
__lua__
function _init()
	debug=false
	trans_drop=false
	ty=-50
	tf=0.9
	tv=6
	cursor=1
	aid=false
	first_aid=true
	guess={}
	check=false
	hearts=3
	hardmode=true
	plays=0
	wins=0
	wins_hard=0
	streak=0
	spoils_heroes=0
	spoils_monsters=0
	spoils_treasure=0

	state="title"
	-- intro
	-- menu
	-- play
	-- lose - 20 guesses
	-- win - correct solution

	chars={
			{
				name="warrior",
				type="hero",
				spr=1,
				spoil="hero",
				min=1,
				max=1,
				code=1,
				palt=14,
				result="none"
			},
			{
				name="archer",
				type="hero",
				spr=2,
				spoil="hero",
				min=1,
				max=1,
				code=1,
				palt=14,
				result="none"
			},
			{
				name="mage",
				type="hero",
				spr=3,
				spoil="hero",
				min=1,
				max=1,
				code=1,
				palt=14,
				result="none"
			},
			{
				name="bat",
				type="monster",
				spr=6,
				spoil="monster",
				min=2,
				max=2,
				code=2,
				palt=14,
				result="none"
			},
			{
				name="spider",
				type="monster",
				spr=7,
				spoil="monster",
				min=3,
				max=3,
				code=2,
				palt=14,
				result="none"
			},
			{
				name="blade orc",
				type="monster",
				spr=8,
				spoil="monster",
				min=2,
				max=1,
				code=2,
				palt=10,
				result="none"
			},
			{
				name="axe orc",
				type="monster",
				spr=9,
				spoil="monster",
				min=2,
				max=1,
				code=2,
				palt=10,
				result="none"
			},
			{
				name="skeleton",
				type="monster",
				spr=10,
				spoil="monster",
				min=1,
				max=4,
				code=2,
				palt=10,
				result="none"
			},
			{
				name="villager",
				type="npc",
				spr=4,
				spoil="none",
				min=1,
				max=1,
				code=1,
				palt=14,
				result="none"
			},
			{
				name="king",
				type="npc",
				spr=5,
				spoil="none",
				min=1,
				max=1,
				code=1,
				palt=14,
				result="none"
			},
			{
				name="zombie",
				type="other",
				spr=22,
				spoil="monster",
				min=1,
				max=0,
				code=3,
				palt=10,
				result="none"
			},
			{
				name="thief",
				type="monster",
				spr=23,
				spoil="monster",
				min=1,
				max=1,
				code=1,
				palt=11,
				result="none"
			},
			{
				name="wizard",
				type="monster",
				spr=24,
				spoil="monster",
				min=1,
				max=1,
				code=5,
				palt=11,
				result="none"
			},
			{
				name="necromancer",
				type="monster",
				spr=25,
				spoil="monster",
				min=1,
				max=1,
				code=2,
				palt=14,
				result="none"
			},
			{
				name="wand",
				type="aid",
				spr=16,
				spoil="none",
				min=1,
				max=1,
				code=-1,
				palt=11,
				result="no aid"
			},
			{
				name="coins",
				type="loot",
				spr=17,
				spoil="loot",
				min=2,
				max=3,
				code=0,
				palt=14,
				result="none"
			},
			{
				name="chest",
				type="loot",
				spr=18,
				spoil="loot",
				min=1,
				max=3,
				code=0,
				palt=14,
				result="none"
			},
			{
				name="relic",
				type="loot",
				spr=19,
				spoil="loot",
				min=1,
				max=1,
				code=5,
				palt=11,
				result="none"
			},
			{
				name="frog",
				type="other",
				spr=20,
				spoil="none",
				min=1,
				max=0,
				code=3,
				palt=14,
				result="none"
			},
			{
				name="dragon",
				type="monster",
				spr=21,
				spoil="monster",
				min=1,
				max=1,
				code=2,
				palt=14,
				result="none"
			}
		}
	
		timers={}
		--length
		--frames
		--current
		--tag
		
		-- solution={"archer",
		-- 	"warrior",
		-- 	"blade orc",
		-- 	"axe orc",
		-- 	"chest"}
		level_init()
end

function level_init()
	solution=build_dungeon()
end

function build_dungeon()
	local dungeon={
		"archer",
		"warrior",
		"blade orc",
		"axe orc",
		"chest"
	}
	local heroes={}
	local mobs={}
	local loot={}
	local npc={}
	local other={}
	local choices=deepcopy(chars)
	for c=1,#chars do
		if(chars[c].type=="hero") add(heroes,chars[c])
		if(chars[c].type=="monster") add(mobs,chars[c])
		if(chars[c].type=="npc") add(npc,chars[c])
		if(chars[c].type=="other") add(other,chars[c])
		if(chars[c].type=="loot") add(loot,chars[c])
	end
	hero1=ceil(rnd(#heroes))
	mob1=ceil(rnd(#mobs))
	loot1=ceil(rnd(#loot))
	-- plus1=flr(rnd(#chars))
	-- plus2=flr(rnd(#chars))
	pos=1
	dungeon[pos]=heroes[hero1].name
	del(heroes,heroes[hero1])
	pos+=1
	if dungeon[pos]=="archer" then
		h=ceil(rnd(#heroes))
		dungeon[pos]=heroes[h].name
		del(heroes,heroes[h])
		pos+=1
	end
	dungeon[pos]=mobs[mob1].name
	pos+=1
	cls()
	print(pos)
	print(dungeon[1])
	print(dungeon[2])
	print(dungeon[3])
	-- stop()
	dungeon[pos]=loot[loot1].name
	pos+=1
	
	return dungeon
end

function _update()
	tnum=#timers
	for t=tnum,1,-1 do
		timers[t].current+=timers[t].speed
		if timers[t].current>timers[t].length then
			del(timers,timers[t])
		end
	end
	if state=="title" then
		if btn(🅾️) and btn(❎) then
			state="play"
		end
	elseif state=="play" then
		play_controls()
	elseif state=="lose" or state=="win" then
		if btn(🅾️) and btn(❎) then
			_init()
		end
	end
end

function _draw()
	cls()
	-- grid lines
	if debug then
		for i=0,127,8 do
			line(i,0,i,127,10)
		end
		rect(0,0,127,127,11)
	end
	if state=="title" then
		map()
		palt(0,false)
		-- palt(9,true)
		--sspr(64,112,59,13,5,10,118,26)
		palt(11,true)
		sspr(64,96,59,13,5,12,118,26)
		palt()
		txt='🅾️+❎ start'
		bprint(txt,centre_text(txt,2),92,7,0)
	elseif state=="play" then
		board()
		characters()
		guesses()
	elseif state=="win" then
		board()
		characters()
		guesses()
		transition("gOT IT!",3)
	elseif state=="lose" then
		print("nOT THIS TIME...")
		transition("nOT THIS TIME...",14)
	end

	timer_draw_actions()
end

function play_controls()
	if btnp(➡️) then 
		if cursor==20 and aid then
			cursor=15
		elseif cursor==20 then
			cursor=16
		elseif cursor==14 then
			cursor=9
		elseif cursor==8 then
			cursor=1
		elseif cursor < #chars then
			cursor+=1
		else 
			cursor=1
		end
	end
	if btnp(⬅️) then 
		if cursor==9 then
			cursor=14
		elseif cursor==16 and aid==false then
			cursor=20
		elseif cursor > 1 then
			cursor-=1
		else 
			cursor=8
		end
	end
	if btnp(⬆️) then
		if cursor==1 or cursor==8 then
			--nothing
		elseif cursor==2 then 
			if aid then
				cursor=15
			else
				cursor=9
			end
		elseif cursor>2 and cursor<8 then
			cursor=13+cursor
		elseif cursor>8 and cursor<15 then
			cursor-=7
		elseif cursor>15 and cursor<21 then
			cursor-=6
		end
	end
	if btnp(⬇️) then
		if cursor==1 or cursor==8 then
			--nothing
		elseif cursor>1 and cursor<8 then
			cursor+=7
		elseif cursor==9 then
			if aid then
				cursor=15
			else
				cursor=2
			end
		elseif cursor>9 and cursor<15 then
			cursor+=6
		elseif cursor>14 and cursor<21 then
			cursor=cursor-13
		end
	end
	if btnp(🅾️) and #timers==0 then
		--add char to current spot
		if chars[cursor].type != "aid" then
			tempchars=deepcopy(chars)
			add(guess,tempchars[cursor])
			guess[#guess].result='guess'
			
			if #guess%5==0 then
				check=true
			end
			
			if chars[cursor].type=="hero" or chars[cursor].type=="npc" or chars[cursor].name=="thief" then
				dir="bump right"
			else
				dir="bump left"
			end
			add(timers,{length=1,speed=1,current=0,lag=0,tag=dir})
			add(timers,{length=6,speed=1,current=0,lag=2,tag="guess pop",val=#guess-1})
			if #guess == 30 then
				state="lose" --will always lose on last guess regardless of result
			end
		else
			--wand behaviour
			--r=flr(rnd(2))
			r=1
			no_guess=0
			for g=1,#chars do
				if (chars[g].result=="none") no_guess+=1
			end
			if r==1 then
				-- 1. reveal 4 if possible
				if no_guess > 4 then 
					reveals=4
				else
					reveals=no_guess
				end
				placed=0
				-- infinite loop somewhere
				inf_break=0
				while placed < reveals or inf_break > 120 do
					for g=1,#chars do
						if flr(rnd(3))==1 and chars[g].result=="none" then
							any_right=0
							for s=1,5 do
								if chars[g].name==solution[s] then
									any_right+=1
								end
							end
							if any_right==0 then
								chars[g].result="wrong"
								placed+=1
							end
						end
						if (placed>=reveals) break
					end
					inf_break+=1
				end

			else
				-- 2. ??
			end
			aid=false
			for c=1,#chars do
				if chars[c].name=="wand" then
					chars[c].result="no aid"
					chars[c].spr=16
				end
			end
			cursor+=1
		end
		add(timers,{length=2,speed=1,current=0,lag=0,tag="button press"})
		add(timers,{length=10,speed=1,current=0,lag=0,tag="select text",val=cursor})	
	elseif btnp(❎) then
		--delete last placed char
		if #guess%5 > 0 then
			del(guess,guess[#guess])
		end
	end
	if (#timers == 0 and check) check_guesses(#guess/5-1)
end

function transition(title,col)
	-- fillp(0b0011001111001100)
	fillp(▒)
	rectfill(0,0,127,127,5)
	fillp()
	if (trans_drop) then
		tv*=tf -- friction
		ty+=tv
		if ty>=0 then
			trans_drop=false
			ty=0
		end
	end
	rectfill(20,6+ty,107,101+ty,0)
	print(title,52,11+ty,col)
	-- plays=0
	-- wins=0
	-- wins_hard=0
	-- streak=0
	-- spoils_heroes=0
	-- spoils_monsters=0
	-- spoils_treasure=0
	print(plays,34,43+ty,7)
	print(wins,62,43+ty,7)
	print(streak,90,43+ty,7)
	print('PLAYS',26,50+ty,6)
	print('WINS',56,50+ty,6)
	print('STREAK',80,50+ty,6)

	print('SPOILS',52,60+ty,6)
	print(spoils_heroes,34,68+ty,7)
	print(spoils_monsters,62,68+ty,7)
	print(spoils_treasure,90,68+ty,7)
	print('PLAYS',26,50+ty,6)
	spr(28,32,76+ty)
	spr(44,59,76+ty)
	spr(60,87,76+ty)

	txt='❎ share result'
	print(txt,centre_text(txt,1),86+ty,7)
	txt='🅾️+❎ next dungleon'
	print(txt,centre_text(txt,2),92+ty,9)
	
	pos=1
	for g=#guess-4,#guess do
		shspr(guess[g].spr,21+pos*13,22+ty,guess[g].palt,highlight,'right','deep')
		pos+=1
	end
end

function shspr(s,x,y,pl,hl,m,bg)
	-- shadow sprite
	-- s = sprite number
	-- x = x position
	-- y = y position
	-- pl = transparency colour
	-- hl = highlight
	-- m = match
	-- bg = background style
	local highlighter=hl

	if highlighter then
		if m=="none" then
			spr(168,x-2,y-2)
			spr(169,x+6,y-2)
			spr(184,x-2,y+6)
			spr(185,x+6,y+6)
		elseif m=="wrong" then
			spr(170,x-2,y-2)
			spr(171,x+6,y-2)
			spr(186,x-2,y+6)
			spr(187,x+6,y+6)
		elseif m=="close" then
			spr(172,x-2,y-2)
			spr(173,x+6,y-2)
			spr(188,x-2,y+6)
			spr(189,x+6,y+6)
		elseif m=="right" then
			spr(174,x-2,y-2)
			spr(175,x+6,y-2)
			spr(190,x-2,y+6)
			spr(191,x+6,y+6)
		elseif m=="yes aid" then
			spr(140,x-2,y-2)
			spr(141,x+6,y-2)
			spr(156,x-2,y+6)
			spr(157,x+6,y+6)
		end
	else
		if bg == "flat" then
			if m=="none" then
				spr(160,x-2,y-2)
				spr(161,x+6,y-2)
				spr(176,x-2,y+6)
				spr(177,x+6,y+6)
			elseif m=="guess" then
				spr(128,x-2,y-2)
				spr(129,x+6,y-2)
				spr(144,x-2,y+6)
				spr(145,x+6,y+6)
			elseif m=="wrong" then
				spr(162,x-2,y-2)
				spr(163,x+6,y-2)
				spr(178,x-2,y+6)
				spr(179,x+6,y+6)
			elseif m=="close" then
				spr(164,x-2,y-2)
				spr(165,x+6,y-2)
				spr(180,x-2,y+6)
				spr(181,x+6,y+6)
			elseif m=="right" then
				spr(166,x-2,y-2)
				spr(167,x+6,y-2)
				spr(182,x-2,y+6)
				spr(183,x+6,y+6)
			elseif m=="no aid" then
				spr(142,x-2,y-2)
				spr(143,x+6,y-2)
				spr(158,x-2,y+6)
				spr(159,x+6,y+6)
			elseif m=="yes aid" then
				spr(138,x-2,y-2)
				spr(139,x+6,y-2)
				spr(154,x-2,y+6)
				spr(155,x+6,y+6)
			end
		else
			if m=="wrong" then
				spr(130,x-2,y-2)
				spr(131,x+6,y-2)
				spr(146,x-2,y+6)
				spr(147,x+6,y+6)
			elseif m=="close" then
				spr(132,x-2,y-2)
				spr(133,x+6,y-2)
				spr(148,x-2,y+6)
				spr(149,x+6,y+6)
			elseif m=="right" then
				spr(134,x-2,y-2)
				spr(135,x+6,y-2)
				spr(150,x-2,y+6)
				spr(151,x+6,y+6)
			end
		end
	end

	for i=0,15 do
		pal(i,0)
	end
	palt(0,false)
	palt(pl,true)

	spr(s,x-1,y)
	spr(s,x,y-1)
	spr(s,x,y+1)	
	spr(s,x+1,y)
	
	pal()
	palt(0,false)
	palt(pl,true)
	spr(s,x,y)
	palt()
end

function board()
	bx=13
	by=13
	of=32
	local b1=0
	local b2=0
	print("DUNGLEON",32,0,7)
	print("L",48,0,14)
	--hearts [optimise]
	if hearts==3 then
		spr(12,74,1)
		spr(12,80,1)
		spr(12,86,1)
	elseif hearts>=2 then
		spr(12,74,1)
		spr(12,80,1)
		if (hearts==2.5) spr(13,86,1)
	elseif hearts>=1 then
		spr(12,74,1)
		if (hearts==1.5) spr(13,80,1)
	elseif hearts==0.5 then
		spr(13,74,1)
	end
	--hard mode gem
	if (hardmode) spr(14,92,1)
	
	for x=0,4 do
		for y=0,5 do
			sx=bx*x
			sy=by*y
			result="none"
			-- backgrounds based on guesses
			if result=="none" then
				b1=128
				b2=144
			elseif result=="wrong" then
				b1=130
				b2=146
			elseif result=="close" then
				b1=132
				b2=148
			elseif result=="right" then
				b1=134
				b2=150
			end
			spr(b1,of+sx,7+sy)
			spr(b1+1,of+sx+8,7+sy)
			spr(b2,of+sx,7+sy+8)
			spr(b2+1,of+sx+8,7+sy+8)
		end
	end
end

function characters()
	for i=1,#chars do
		if cursor == i then
			highlight=true
		else
			highlight=false
		end
		if i>14 then
			shspr(chars[i].spr,2+13*(i-13),114,chars[i].palt,highlight,chars[i].result,'flat')
		elseif i>8 then
			shspr(chars[i].spr,2+13*(i-7),101,chars[i].palt,highlight,chars[i].result,'flat')
		else
			shspr(chars[i].spr,2+13*i,88,chars[i].palt,highlight,chars[i].result,'flat')
		end
	end
end

function guesses()
	newline=0
	offx=0
	if #guess > 0 then
		for i=1,#guess do
			highlight=false
			shspr(guess[i].spr,21+13*(i-newline*5),9+13*newline,guess[i].palt,highlight,guess[i].result,'deep')
			if(i%5==0) newline+=1
		end
	end
end

function check_guesses(row)
	right=0
	wiz_check=0
	for g=1,5 do
		correct=0
		for s=1,5 do
			if guess[g+row*5].name==solution[s] then
				correct+=1
				if g!=s then
					guess[g+row*5].result='close'
				else	
					guess[g+row*5].result='right'
					right+=1
					wiz_check+=1
				end
			end
		end
		if correct==0 then
			guess[g+row*5].result='wrong'
		end
		for c=1,#chars do
			if guess[g+row*5].name==chars[c].name then
				chars[c].result=guess[g+row*5].result
			end
		end
	end
	if right==5 then
		state='win'
		wins+=1
		plays+=1
		trans_drop=true
	end
	if (right==4 or wiz_check>0) and first_aid then
		aid=true
		first_aid=false
		for c=1,#chars do
			if chars[c].name=="wand" then
				chars[c].result="yes aid"
				chars[c].spr=32
			end
		end
	end
	check=false
	hearts-=0.5
end

function timer_draw_actions()
	for t=1,#timers do
		if timers[t].current > timers[t].lag then
			if timers[t].tag == "bump right" then
				camera(timers[t].current,0)
			elseif timers[t].tag == "bump left" then
				camera(-timers[t].current,0)
			else
				camera(0,0)
			end
			if timers[t].tag == "button press" then
				for i=1,#chars do
					if cursor == i then
						if i>14 then
							cx=2+13*(i-13)
							cy=114
						elseif i>8 then
							cx=2+13*(i-7)
							cy=101
						else
							cx=2+13*i
							cy=88
						end
					end
				end
				pal(5,0)
				spr(128,cx-2,cy-2)
				spr(129,cx+6,cy-2)
				spr(144,cx-2,cy+6)
				spr(145,cx+6,cy+6)
				pal()
			end
			if timers[t].tag == "select text" then
				name=chars[timers[t].val].name
				y=79
				if(#guess > 25) y=66
				bprint(name,centre_text(name,0),y,7,1)
			end
			if timers[t].tag == "guess pop" then
				s1=192
				s2=208
				palt(14,true)
				palt(0,false)
				sx=timers[t].val%5*13+31
				sy=flr(timers[t].val/5)*13+6
				spr(s1,sx,sy)
				spr(s1+1,sx+8,sy)
				spr(s2,sx,sy+8)
				spr(s2+1,sx+8,sy+8)
				palt()
			end
		end
	end
end

-- utilities
function bprint(str,x,y,c1,c2)
	--print text with borders
	color(c2)
	print(str,x-1,y-1)
	print(str,x-1,y)
	print(str,x,y-1)
	print(str,x+1,y+1)
	print(str,x+1,y)
	print(str,x,y+1)

	print(str,x,y,c1)
end

function centre_text(str,special_chars)
	pos=((32*4)-(#str*4+special_chars*4))/2
	return pos
end

function deepcopy(orig)
	--copy a list to another without keeping the references to the original
    local orig_type = type(orig)
    local copy
    if orig_type == 'table' then
        copy = {}
        for orig_key, orig_value in next, orig, nil do
            copy[deepcopy(orig_key)] = deepcopy(orig_value)
        end
        setmetatable(copy, deepcopy(getmetatable(orig)))
    else -- number, string, boolean, etc
        copy = orig
    end
    return copy
end
__gfx__
0000000077e8cccc88bee88eeaaaaeee7674444eeeae9eaedddeeccce22e2eeea2222a7aa22aa6a6aaaaaa6aeeeeeeee0e0800000e0000000b30000000000000
00000000e77c1c1ce8bbb008eb3888ee76766644eeaabaaed2eeecfeeee11122222222672222a6767777a65aeebbbeeeeee88000eee00000b7b3000000000000
00700700ee666666bb0bbb083b3aaaae777cfcf45644f44ed7ee7ceee22111e2a7e732677e7326760707a65aeb333bee0e8800000e8000003b33000000000000
00077000ea00b0be9070700883ac6caeed4ffffe65f1f1fe70d707ee27e7112e233332673e332646777aa659b333331e00800000008000000330000000000000
00077000ea777cccbb000bbd836666ee47ef77eeccf444fee7dd721e707072e223332a332332034aa77aa99ab300031e00000000000000000000000000000000
007007005a55571cdbb3b0088386777e4d44ff4ecc49994eeeec212ecccc2e2eaa111a3323324033aa22977ab333331e00000000000000000000000000000000
00000000ea777c1cbbb3b008e388767eed4aaa4ecc99999eecc2ee2ecece2e2e336667aaaa44403377a2277ae13331ee00000000000000000000000000000000
00000000ea2e2eceeddedd8e8388767eede4e4eecc99999eee2ee2ee8e82ee2e3377733a330aa04a77a22aaaee111eee00000000000000000000000000000000
bbb65bbbeeeeeeeeeee9999ebb99bbbbee7eee7eeeeeeeeeaaaaeeaabbbbbbbbbbbbb7bbbebebbeb00000000eeeeeeee00a77700000000000009900000000000
bb6505bbeeee99eeeee00009baabbbbbe7073707e88888deaa1ceeea111111bbb44b7e7beb777bbd00000000ee888eee45a1117000777700009aa90000000000
bbb65bbbeee9aa9eeef90009b99bbbbbe373337e8888788e1117cccab111111bb40447bbee8787be00000000e82228ee00accc00000706000049900000000000
bbd001bbeeee994eeed5aa09bbaabbbbee333333767688ee111cc7cab108e81b4000a0abee607bdb000000008202021e000000000076700009aa400000000000
bbbd1bbbe66e4aa9eef94409bae89babe9aaaab3787882ee1c8ccc1abb11ee1b47074a4bee5072be000000008220221e00000000000770000099000000000000
bbbd1bbb6666e99eeed5aa9ea8889acae99aaab38888002ea88cc11a1766aa33b4044334e277222e000000008202021e00000000000000000000000000000000
bbbd1bbb5665eeeee9999944a829bad9eb999be32022222eaaaaa1aa10777a334044433baa20227700000000e12221ee00000000000000000000000000000000
bbbd1bbbe55eeeeee999994eb99bbb9bbeeebe33707ddd8ecaaaaaca1111144b44044abbe220222200000000ee111eee00000000000000000000000000000000
bbb7fbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000333300000000000000000000000000
bb7e2fbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000838500000000000000000000000000
bbb7fbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000353000000000000000000000000000
bba009bb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000033000000000000000000000000000
bbba9bbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbba9bbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbba9bbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbba9bbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000099000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009aa900000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000499000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009aa4000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000990000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
05555555555000000eeeeeeeeee000000aaaaaaaaaa000000bbbbbbbbbb000000666666666600000000055550000000000006666000000000000111100000000
5000000000050000e2222222222e0000a9999999999a0000b3333333333b00006666666666660000005555555500000000666666660000000011000011000000
50000000000500002222222222220000999999999999000033333333333300006666666666660000055555555550000006666666666000000100000000100000
50000000000500002222222222220000999999999999000033333333333300006666666666660000055555555550000006666666666000000100000000100000
50000000000500002222222222220000999999999999000033333333333300006666666666660000555555555555000066666666666600001000000000010000
50000000000500002222222222220000999999999999000033333333333300006666666666660000555555555555000066666666666600001000000000010000
50000000000500002222222222220000999999999999000033333333333300006666666666660000555555555555000066666666666600001000000000010000
50000000000500002222222222220000999999999999000033333333333300006666666666660000555555555555000066666666666600001000000000010000
50000000000500002222222222220000999999999999000033333333333300006666666666660000055555555550000006666666666000000100000000100000
50000000000500002222222222220000999999999999000033333333333300006666666666660000055555555550000006666666666000000100000000100000
50000000000500001222222222210000199999999991000013333333333100006666666666660000005555555500000000666666660000000011000011000000
05555555555000000111111111100000011111111110000001111111111000000666666666600000000055550000000000006666000000000000111100000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
055555555550000002222222222000000999999999900000033333333330000006666666666000000eeeeeeeeee000000aaaaaaaaaa000000bbbbbbbbbb00000
55555555555500002222222222220000999999999999000033333333333300006666666666660000eeeeeeeeeeee0000aaaaaaaaaaaa0000bbbbbbbbbbbb0000
55555555555500002222222222220000999999999999000033333333333300006666666666660000eeeeeeeeeeee0000aaaaaaaaaaaa0000bbbbbbbbbbbb0000
55555555555500002222222222220000999999999999000033333333333300006666666666660000eeeeeeeeeeee0000aaaaaaaaaaaa0000bbbbbbbbbbbb0000
55555555555500002222222222220000999999999999000033333333333300006666666666660000eeeeeeeeeeee0000aaaaaaaaaaaa0000bbbbbbbbbbbb0000
55555555555500002222222222220000999999999999000033333333333300006666666666660000eeeeeeeeeeee0000aaaaaaaaaaaa0000bbbbbbbbbbbb0000
55555555555500002222222222220000999999999999000033333333333300006666666666660000eeeeeeeeeeee0000aaaaaaaaaaaa0000bbbbbbbbbbbb0000
55555555555500002222222222220000999999999999000033333333333300006666666666660000eeeeeeeeeeee0000aaaaaaaaaaaa0000bbbbbbbbbbbb0000
55555555555500002222222222220000999999999999000033333333333300006666666666660000eeeeeeeeeeee0000aaaaaaaaaaaa0000bbbbbbbbbbbb0000
55555555555500002222222222220000999999999999000033333333333300006666666666660000eeeeeeeeeeee0000aaaaaaaaaaaa0000bbbbbbbbbbbb0000
55555555555500002222222222220000999999999999000033333333333300006666666666660000eeeeeeeeeeee0000aaaaaaaaaaaa0000bbbbbbbbbbbb0000
055555555550000002222222222000000999999999900000033333333330000006666666666000000eeeeeeeeee000000aaaaaaaaaa000000bbbbbbbbbb00000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e555555555555eee55555555555555550000000000000000dddd0ddddddd0dddbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
50000000000005eeddddddddddddddd56666666666666660111d0111111d0111b0000000b00000000000000000000000000bb000000000000000000000bbbbbb
50eeeeeeeeee05ee01111111111111d51555555555555560111d0111111d0111b06666600660666066006600666600eeee0b0066666006666006600660bbbbbb
50eeeeeeeeee05ee01111111111111d515555555555555600000000000000000b06606660660666066606606666660eeee0b0666666066066606660660bbbbbb
50eeeeeeeeee05ee01111111111111d51555555555555560ddddddd0ddddddd0b06606660660666066666606606660eeee0b0666000066066606666660bbbbbb
50eeeeeeeeee05ee01111111111111d51555555555555560111111d0111111d0b06606660660666066666606600000eeee0b0666666066066606666660bbbbbb
50eeeeeeeeee05ee01111111111111d51555555555555560111111d0111111d0b06606660660666066666606606660eeee0b0666666066066606666660bbbbbb
50eeeeeeeeee05ee00000000000000d511111111111111600000000000000000b06606660660666066666606600660eeee000666000066066606666660bbbbbb
50eeeeeeeeee05ee55555555555555550000000000000000ddd0ddddddd0ddddb06606660666666066066606666660eeeeee0666666066066606606660bbbbbb
50eeeeeeeeee05eeddddddd5dddddddd666666606666666611d0111111d01111b06666600066660066006600666660eeeeee0066666006666006600660bbbbbb
50eeeeeeeeee05ee111111d501111111555555601555555511d0111111d01111b0000000b0000000000000000000000000000000000b000000b0000000bbbbbb
50eeeeeeeeee05ee111011d50111100155555560155555550000000000000000b000000bbb0000bb00bb00bb00000b000000bb00000bb0000bb00bb00bbbbbbb
50000000000005ee111101d50111011155555560155555550ddddddd0dddddddbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
e555555555555eee111111d50111111155555560155555550111111d0111111dbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
eeeeeeeeeeeeeeee101111d50111111155555560155555550111111d0111111dbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
eeeeeeeeeeeeeeee000000d50000000011111160111111110000000000000000bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
5555555555555555555555555555555555555555555555555555555555555555ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc99999
ddddddddddddddd5ddddddddddddddd50000000000000005ddddddddddddddd5c0000000000000000000000000000000000cc000000000000000000000c99999
01111111111111d501101111111111d5011111111111110501111111111111d5c06666600660666066006600666600eeee0c0066666006666006600660c99999
01111111111111d501011111111111d5011111111111110501111111111111d5c06606660660666066606606666660eeee0c0666666066066606660660c99999
01111111111111d501111111110111d5011111111111110501111111111111d5c06606660660666066666606606660eeee0c0666000066066606666660c99999
01111111111111d501101111110111d5011111111111110501111111111111d5c06606660660666066666606600000eeee0c0666666066066606666660c99999
01111111111111d501111111101111d5011111111111110501111111111111d5c06606660660666066666606606660eeee0c0666666066066606666660c99999
00000000000000d500000000000000d5000000000000000500000000000000d5c06606660660666066666606600660eeee000666000066066606666660c99999
5555555555555555555555555555555555555555555555555555555555555555c06606660666666066066606666660eeeeee0666666066066606606660c99999
ddddddd5ddddddddddddddd5ddddddddddddddd5ddddddddddddddd5ddddddddc06666600066660066006600666660eeeeee0066666006666006600660c99999
111111d501111111111111d501111111111111d501111111111111d501111111c0000000c0000000000000000000000000000000000c000000c0000000c99999
111011d501111001111111d501111111111111d501111111111111d501111111c000000ccc0000cc00cc00cc00000c000000cc00000cc0000cc00cc00cc99999
111101d501110111111111d501111111111111d501111111111111d501111111cccccccc9cccccc9cccccccccccccccccccccccccccccccccccccccccc999999
111111d501111111111111d501111111111111d501111111111111d5011111119999999999999999999999999999999999999999999999999999999999999999
101111d501111111111111d501111111111111d501111111111111d5011111119999999999999999999999999999999999999999999999999999999999999999
000000d500000000000000d500000000000000d500000000000000d5000000009999999999999999999999999999999999999999999999999999999999999999
__map__
e6e7e6e7e6e7e6e7e6e7e6e7e6e7e6e700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
f6f7f6f7f6f7f6f7f6f7f6f7f6f7f6f700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e6e7e6e7e6e7e6e7e6e7e6e7e6e7e6e700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
f6f7f6f7f6f7f6f7f6f7f6f7f6f7f6f700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e6e7e6e7e6e7e6e7e6e7e6e7e6e7e6e700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
f6f7f6f7f6f7f6f7f6f7f6f7f6f7f6f700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e6e7e6e7e6e7e6e7e6e7e6e7e4e5e6e700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
f6f7f6f7f6f7f6f7f6f7f6f7f4f5f6f700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e6e7e6e7e6e7e4e5e6e7e6e7e6e7e6e700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
f6f7f6f7f6f7f4f5f6e2e3f7f6f7f6f700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e6e7e2e3e6e7e0e1e6f2f3e7e6e7e6e700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
f6f7f2f3f6f7f0f1f6f7f6f7f6f7f6f700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e6e7e6e7e6e7e6e7e6e7c2c3e6e7e4e500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
f6f7f6f7f6f7f6f7f6f7d2d3f6f7f4f500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e6e7e0e1e2e3e6e7e6e7e0e1e6e7e6e700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
f6f7f0f1f2f3f6f7f6f7f0f1f6f7f6f700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__change_mask__
fffffffffbfffffffbfffffffbfffffffbfffffffbfffffffbfffffffbfffffffbfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffbfffffffbfffffffbfffffffbfffffffbfffffffbfffffffbfffffffbfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffbfffffffbfffffffbfffffffbfffffffbfffffffbfffffffbfffffffbfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffbfffffffbfffffffbfffffffbfffffffbfffffffbfffffffbfffffffbfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffbfffffffbfffffffbfffffffbfffffffbfffffffbfffffffbfffffffbfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffbfffffffbfffffffbfffffffbfffffffbfffffffbfffffffbfffffffbffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
